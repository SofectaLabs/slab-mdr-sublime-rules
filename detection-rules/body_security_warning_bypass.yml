name: "Security Warning Bypass"
description: "Detects messages using HTML/CSS to obfuscate or remove security warning headers."
type: "rule"
severity: "high"
source: |
  type.inbound
  and regex.imatch(body.html.raw,".*\\sbody\\s*{[^}]+display:\\s+none.*?}.*") and regex.imatch(body.html.raw,".*display:\\sblock.*")

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Evasion"
  - "HTML Smuggling"
  - "Scripting"
  - "Warning Bypass"
detection_methods:
  - "Content analysis"
  - "HTML analysis"
references: 
  - "https://whynotsecurity.com/blog/external-email-warning-bypass/"

id: "2fc36c6d-86a2-5b12-b5a4-5d8744858381"
